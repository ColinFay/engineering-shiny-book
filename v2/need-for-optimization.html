<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 The Need for Optimization | Engineering Production-Grade Shiny Apps</title>
  <meta name="description" content="A book about engineering shiny application that will later be sent to production. This book cover project management, structuring your project, building a solid testing suite, and optimizing your codebase. We describe in this book a specific workflow: design, prototype, build, strengthen and deploy." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 The Need for Optimization | Engineering Production-Grade Shiny Apps" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://raw.githubusercontent.com/ThinkR-open/engineering-shiny-book/master/img/engineering-shiny.jpg" />
  <meta property="og:description" content="A book about engineering shiny application that will later be sent to production. This book cover project management, structuring your project, building a solid testing suite, and optimizing your codebase. We describe in this book a specific workflow: design, prototype, build, strengthen and deploy." />
  <meta name="github-repo" content="ThinkR-open/engineering-shiny-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 The Need for Optimization | Engineering Production-Grade Shiny Apps" />
  
  <meta name="twitter:description" content="A book about engineering shiny application that will later be sent to production. This book cover project management, structuring your project, building a solid testing suite, and optimizing your codebase. We describe in this book a specific workflow: design, prototype, build, strengthen and deploy." />
  <meta name="twitter:image" content="https://raw.githubusercontent.com/ThinkR-open/engineering-shiny-book/master/img/engineering-shiny.jpg" />

<meta name="author" content="Colin Fay" />
<meta name="author" content="Sébastien Rochette" />
<meta name="author" content="Vincent Guyader" />
<meta name="author" content="Cervan Girard" />


<meta name="date" content="2024-03-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
<link rel="prev" href="deploy.html"/>
<link rel="next" href="common-app-caveats.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-149994171-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-149994171-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/thinkr.css" type="text/css" />
<link rel="stylesheet" href="css/style_gitbook.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Engineering Production-Grade Shiny Apps</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#audience-for-this-book"><i class="fa fa-check"></i>Audience for this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-production"><i class="fa fa-check"></i>What is “production”?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-structure"><i class="fa fa-check"></i>Book structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#colin-fay"><i class="fa fa-check"></i><a href="https://colinfay.me/">Colin Fay</a></a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#sébastien-rochette"><i class="fa fa-check"></i><a href="https://statnmap.com/">Sébastien Rochette</a></a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#vincent-guyader"><i class="fa fa-check"></i><a href="https://twitter.com/VincentGuyader">Vincent Guyader</a></a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#cervan-girard"><i class="fa fa-check"></i><a href="https://twitter.com/CervanGirard">Cervan Girard</a></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i>Disclaimer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#want-to-help"><i class="fa fa-check"></i>Want to help?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i>Other resources</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started-with-shiny"><i class="fa fa-check"></i>Getting started with <code>{shiny}</code></a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#putting-shiny-into-production"><i class="fa fa-check"></i>Putting <code>{shiny}</code> into production</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#special-thanks"><i class="fa fa-check"></i>Special thanks</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors-to-this-book"><i class="fa fa-check"></i>Contributors to this book</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="application-presentation.html"><a href="application-presentation.html"><i class="fa fa-check"></i>Application presentation</a>
<ul>
<li class="chapter" data-level="" data-path="application-presentation.html"><a href="application-presentation.html#hexmake"><i class="fa fa-check"></i><code>{hexmake}</code></a></li>
<li class="chapter" data-level="" data-path="application-presentation.html"><a href="application-presentation.html#tidytuesday201942"><i class="fa fa-check"></i><code>{tidytuesday201942}</code></a></li>
<li class="chapter" data-level="" data-path="application-presentation.html"><a href="application-presentation.html#minifying"><i class="fa fa-check"></i><code>{minifying}</code></a></li>
<li class="chapter" data-level="" data-path="application-presentation.html"><a href="application-presentation.html#other-applications"><i class="fa fa-check"></i>Other applications</a></li>
</ul></li>
<li class="part"><span><b>I Building Successful {shiny} Apps</b></span></li>
<li class="chapter" data-level="1" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html"><i class="fa fa-check"></i><b>1</b> About Successful <code>{shiny}</code> Apps</a>
<ul>
<li class="chapter" data-level="1.1" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#a-very-short-introduction-to-shiny"><i class="fa fa-check"></i><b>1.1</b> A (very) short introduction to <code>{shiny}</code></a></li>
<li class="chapter" data-level="1.2" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#complex-shiny"><i class="fa fa-check"></i><b>1.2</b> What is a complex <code>{shiny}</code> application?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#reaching-the-cliff-of-complexity"><i class="fa fa-check"></i><b>1.2.1</b> Reaching the cliff of complexity</a></li>
<li class="chapter" data-level="1.2.2" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#balancing-complexities"><i class="fa fa-check"></i><b>1.2.2</b> Balancing complexities</a></li>
<li class="chapter" data-level="1.2.3" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#assessing-code-complexity"><i class="fa fa-check"></i><b>1.2.3</b> Assessing code complexity</a></li>
<li class="chapter" data-level="1.2.4" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#production-grade-software-engineering"><i class="fa fa-check"></i><b>1.2.4</b> Production-grade software engineering</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#what-is-a-successful-shiny-app"><i class="fa fa-check"></i><b>1.3</b> What is a successful <code>{shiny}</code> app?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#it-exists"><i class="fa fa-check"></i><b>1.3.1</b> It exists</a></li>
<li class="chapter" data-level="1.3.2" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#it-is-accurate"><i class="fa fa-check"></i><b>1.3.2</b> It is accurate</a></li>
<li class="chapter" data-level="1.3.3" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#it-is-usable"><i class="fa fa-check"></i><b>1.3.3</b> It is usable</a></li>
<li class="chapter" data-level="1.3.4" data-path="successful-shiny-app.html"><a href="successful-shiny-app.html#it-is-immortal"><i class="fa fa-check"></i><b>1.3.4</b> It is immortal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="planning-ahead.html"><a href="planning-ahead.html"><i class="fa fa-check"></i><b>2</b> Planning Ahead</a>
<ul>
<li class="chapter" data-level="2.1" data-path="planning-ahead.html"><a href="planning-ahead.html#working-with-a-long-term-mindset"><i class="fa fa-check"></i><b>2.1</b> Working with a “long-term” mindset</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="planning-ahead.html"><a href="planning-ahead.html#prepare-for-success"><i class="fa fa-check"></i><b>2.1.1</b> Prepare for success</a></li>
<li class="chapter" data-level="2.1.2" data-path="planning-ahead.html"><a href="planning-ahead.html#develop-with-the-kiss-principle"><i class="fa fa-check"></i><b>2.1.2</b> Develop with the KISS principle</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="planning-ahead.html"><a href="planning-ahead.html#working-as-a-team-tools-and-structure"><i class="fa fa-check"></i><b>2.2</b> Working as a team: Tools and structure</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="planning-ahead.html"><a href="planning-ahead.html#from-the-tools-point-of-view"><i class="fa fa-check"></i><b>2.2.1</b> From the tools point of view</a></li>
<li class="chapter" data-level="2.2.2" data-path="planning-ahead.html"><a href="planning-ahead.html#from-the-team-point-of-view"><i class="fa fa-check"></i><b>2.2.2</b> From the team point of view</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structuring-project.html"><a href="structuring-project.html"><i class="fa fa-check"></i><b>3</b> Structuring Your Project</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structuring-project.html"><a href="structuring-project.html#shiny-app-as-a-package"><i class="fa fa-check"></i><b>3.1</b> <code>{shiny}</code> app as a package</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="structuring-project.html"><a href="structuring-project.html#what-is-in-a-production-grade-shiny-app"><i class="fa fa-check"></i><b>3.1.1</b> What is in a production-grade <code>{shiny}</code> app?</a></li>
<li class="chapter" data-level="3.1.2" data-path="structuring-project.html"><a href="structuring-project.html#resources"><i class="fa fa-check"></i><b>3.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="structuring-project.html"><a href="structuring-project.html#using-shiny-modules"><i class="fa fa-check"></i><b>3.2</b> Using <code>{shiny}</code> modules</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structuring-project.html"><a href="structuring-project.html#why-shiny-modules"><i class="fa fa-check"></i><b>3.2.1</b> Why <code>{shiny}</code> modules?</a></li>
<li class="chapter" data-level="3.2.2" data-path="structuring-project.html"><a href="structuring-project.html#when-to-use-shiny-modules"><i class="fa fa-check"></i><b>3.2.2</b> When to use <code>{shiny}</code> modules</a></li>
<li class="chapter" data-level="3.2.3" data-path="structuring-project.html"><a href="structuring-project.html#a-practical-walkthrough"><i class="fa fa-check"></i><b>3.2.3</b> A practical walkthrough</a></li>
<li class="chapter" data-level="3.2.4" data-path="structuring-project.html"><a href="structuring-project.html#communication-between-modules"><i class="fa fa-check"></i><b>3.2.4</b> Communication between modules</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structuring-project.html"><a href="structuring-project.html#structuring-your-app"><i class="fa fa-check"></i><b>3.3</b> Structuring your app</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="structuring-project.html"><a href="structuring-project.html#business-logic-and-application-logic"><i class="fa fa-check"></i><b>3.3.1</b> Business logic and application logic</a></li>
<li class="chapter" data-level="3.3.2" data-path="structuring-project.html"><a href="structuring-project.html#small-is-beautiful-bis-repetita"><i class="fa fa-check"></i><b>3.3.2</b> Small is beautiful (bis repetita)</a></li>
<li class="chapter" data-level="3.3.3" data-path="structuring-project.html"><a href="structuring-project.html#conventions-matter"><i class="fa fa-check"></i><b>3.3.3</b> Conventions matter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="golem.html"><a href="golem.html"><i class="fa fa-check"></i><b>4</b> Introduction to <code>{golem}</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="golem.html"><a href="golem.html#what-is-golem"><i class="fa fa-check"></i><b>4.1</b> What is <code>{golem}</code>?</a></li>
<li class="chapter" data-level="4.2" data-path="golem.html"><a href="golem.html#understanding-golem-app-structure"><i class="fa fa-check"></i><b>4.2</b> Understanding <code>{golem}</code> app structure</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="golem.html"><a href="golem.html#description-and-namespace"><i class="fa fa-check"></i><b>4.2.1</b> <code>DESCRIPTION</code> and <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="golem.html"><a href="golem.html#r"><i class="fa fa-check"></i><b>4.2.2</b> R/</a></li>
<li class="chapter" data-level="4.2.3" data-path="golem.html"><a href="golem.html#golem-config"><i class="fa fa-check"></i><b>4.2.3</b> <code>golem-config</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="golem.html"><a href="golem.html#instappwww"><i class="fa fa-check"></i><b>4.2.4</b> <code>inst/app/www/</code></a></li>
<li class="chapter" data-level="4.2.5" data-path="golem.html"><a href="golem.html#dev"><i class="fa fa-check"></i><b>4.2.5</b> <code>dev/</code></a></li>
<li class="chapter" data-level="4.2.6" data-path="golem.html"><a href="golem.html#man"><i class="fa fa-check"></i><b>4.2.6</b> <code>man/</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>5</b> The Workflow</a>
<ul>
<li class="chapter" data-level="5.1" data-path="workflow.html"><a href="workflow.html#step-1-design"><i class="fa fa-check"></i><b>5.1</b> Step 1: Design</a></li>
<li class="chapter" data-level="5.2" data-path="workflow.html"><a href="workflow.html#step-2-prototype"><i class="fa fa-check"></i><b>5.2</b> Step 2: Prototype</a></li>
<li class="chapter" data-level="5.3" data-path="workflow.html"><a href="workflow.html#step-3-build"><i class="fa fa-check"></i><b>5.3</b> Step 3: Build</a></li>
<li class="chapter" data-level="5.4" data-path="workflow.html"><a href="workflow.html#step-4-strengthen"><i class="fa fa-check"></i><b>5.4</b> Step 4: Strengthen</a></li>
<li class="chapter" data-level="5.5" data-path="workflow.html"><a href="workflow.html#step-5-deploy"><i class="fa fa-check"></i><b>5.5</b> Step 5: Deploy</a></li>
</ul></li>
<li class="part"><span><b>II Step 1: Design</b></span></li>
<li class="chapter" data-level="6" data-path="ux-matters.html"><a href="ux-matters.html"><i class="fa fa-check"></i><b>6</b> UX Matters</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ux-matters.html"><a href="ux-matters.html#simplicity-is-gold"><i class="fa fa-check"></i><b>6.1</b> Simplicity is gold</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="ux-matters.html"><a href="ux-matters.html#how-we-read-the-web-scanning-content"><i class="fa fa-check"></i><b>6.1.1</b> How we read the web: Scanning content</a></li>
<li class="chapter" data-level="6.1.2" data-path="ux-matters.html"><a href="ux-matters.html#building-a-self-evident-app-or-at-least-self-explanatory"><i class="fa fa-check"></i><b>6.1.2</b> Building a self-evident app (or at least self-explanatory)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="ux-matters.html"><a href="ux-matters.html#the-danger-of-feature-creep"><i class="fa fa-check"></i><b>6.2</b> The danger of feature-creep</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ux-matters.html"><a href="ux-matters.html#what-is-feature-creep"><i class="fa fa-check"></i><b>6.2.1</b> What is feature-creep?</a></li>
<li class="chapter" data-level="6.2.2" data-path="ux-matters.html"><a href="ux-matters.html#too-much-reactivity"><i class="fa fa-check"></i><b>6.2.2</b> Too much reactivity</a></li>
<li class="chapter" data-level="6.2.3" data-path="ux-matters.html"><a href="ux-matters.html#too-much-interactivity"><i class="fa fa-check"></i><b>6.2.3</b> Too much interactivity</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ux-matters.html"><a href="ux-matters.html#web-accessibility"><i class="fa fa-check"></i><b>6.3</b> Web accessibility</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ux-matters.html"><a href="ux-matters.html#about-accessibility"><i class="fa fa-check"></i><b>6.3.1</b> About accessibility</a></li>
<li class="chapter" data-level="6.3.2" data-path="ux-matters.html"><a href="ux-matters.html#making-your-app-accessible"><i class="fa fa-check"></i><b>6.3.2</b> Making your app accessible</a></li>
<li class="chapter" data-level="6.3.3" data-path="ux-matters.html"><a href="ux-matters.html#evaluating-your-app-accessibility-and-further-reading"><i class="fa fa-check"></i><b>6.3.3</b> Evaluating your app accessibility and further reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html"><i class="fa fa-check"></i><b>7</b> Don’t Rush into Coding</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#designing-before-coding"><i class="fa fa-check"></i><b>7.1</b> Designing before coding</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#the-urge-to-code"><i class="fa fa-check"></i><b>7.1.1</b> The urge to code</a></li>
<li class="chapter" data-level="7.1.2" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#knowing-where-to-search"><i class="fa fa-check"></i><b>7.1.2</b> Knowing where to search</a></li>
<li class="chapter" data-level="7.1.3" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#about-concept-map"><i class="fa fa-check"></i><b>7.1.3</b> About concept map</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#ask-questions"><i class="fa fa-check"></i><b>7.2</b> Ask questions</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#about-the-end-users"><i class="fa fa-check"></i><b>7.2.1</b> About the end users</a></li>
<li class="chapter" data-level="7.2.2" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#building-personas"><i class="fa fa-check"></i><b>7.2.2</b> Building personas</a></li>
<li class="chapter" data-level="7.2.3" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#pre-existing-code-base"><i class="fa fa-check"></i><b>7.2.3</b> Pre-existing code-base</a></li>
<li class="chapter" data-level="7.2.4" data-path="dont-rush-into-coding.html"><a href="dont-rush-into-coding.html#deployment"><i class="fa fa-check"></i><b>7.2.4</b> Deployment</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Step 2: Prototype</b></span></li>
<li class="chapter" data-level="8" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html"><i class="fa fa-check"></i><b>8</b> Setting up for Success with <code>{golem}</code></a>
<ul>
<li class="chapter" data-level="8.1" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#create-a-golem"><i class="fa fa-check"></i><b>8.1</b> Create a <code>{golem}</code></a></li>
<li class="chapter" data-level="8.2" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#setting-things-up-with-dev01_start.r"><i class="fa fa-check"></i><b>8.2</b> Setting things up with <code>dev/01_start.R</code></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#fill-the-description-and-set-options"><i class="fa fa-check"></i><b>8.2.1</b> Fill the DESCRIPTION and set options</a></li>
<li class="chapter" data-level="8.2.2" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#set-common-files"><i class="fa fa-check"></i><b>8.2.2</b> Set common files</a></li>
<li class="chapter" data-level="8.2.3" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#use-recommended-elements"><i class="fa fa-check"></i><b>8.2.3</b> Use recommended elements</a></li>
<li class="chapter" data-level="8.2.4" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#add-utility-functions"><i class="fa fa-check"></i><b>8.2.4</b> Add utility functions</a></li>
<li class="chapter" data-level="8.2.5" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#changing-the-favicon"><i class="fa fa-check"></i><b>8.2.5</b> Changing the favicon</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#setting-infrastructure-for-prototyping"><i class="fa fa-check"></i><b>8.3</b> Setting infrastructure for prototyping</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#add-modules-in-dev02_dev.r"><i class="fa fa-check"></i><b>8.3.1</b> Add modules in <code>dev/02_dev.R</code></a></li>
<li class="chapter" data-level="8.3.2" data-path="setting-up-for-success.html"><a href="setting-up-for-success.html#add-css-and-js-files"><i class="fa fa-check"></i><b>8.3.2</b> Add CSS and JS files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="building-ispum-app.html"><a href="building-ispum-app.html"><i class="fa fa-check"></i><b>9</b> Building an “ipsum-app”</a>
<ul>
<li class="chapter" data-level="9.1" data-path="building-ispum-app.html"><a href="building-ispum-app.html#prototyping-is-crucial"><i class="fa fa-check"></i><b>9.1</b> Prototyping is crucial</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="building-ispum-app.html"><a href="building-ispum-app.html#prototype-then-polish"><i class="fa fa-check"></i><b>9.1.1</b> Prototype, then polish</a></li>
<li class="chapter" data-level="9.1.2" data-path="building-ispum-app.html"><a href="building-ispum-app.html#the-ui-first-approach"><i class="fa fa-check"></i><b>9.1.2</b> The “UI first” approach</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="building-ispum-app.html"><a href="building-ispum-app.html#prototyping-shiny"><i class="fa fa-check"></i><b>9.2</b> Prototyping <code>{shiny}</code></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="building-ispum-app.html"><a href="building-ispum-app.html#fast-ui-prototyping-with-shinipsum"><i class="fa fa-check"></i><b>9.2.1</b> Fast UI prototyping with <code>{shinipsum}</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="building-ispum-app.html"><a href="building-ispum-app.html#using-fakir-for-fake-data-generation"><i class="fa fa-check"></i><b>9.2.2</b> Using <code>{fakir}</code> for fake data generation</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="building-ispum-app.html"><a href="building-ispum-app.html#proto-rmdfirst"><i class="fa fa-check"></i><b>9.3</b> Building with RMarkdown</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="building-ispum-app.html"><a href="building-ispum-app.html#define-the-content-of-the-application"><i class="fa fa-check"></i><b>9.3.1</b> Define the content of the application</a></li>
<li class="chapter" data-level="9.3.2" data-path="building-ispum-app.html"><a href="building-ispum-app.html#using-the-rmd-files-as-a-laboratory-notebook"><i class="fa fa-check"></i><b>9.3.2</b> Using the Rmd files as a laboratory notebook</a></li>
<li class="chapter" data-level="9.3.3" data-path="building-ispum-app.html"><a href="building-ispum-app.html#rmd-vignettes-and-documentation-first"><i class="fa fa-check"></i><b>9.3.3</b> Rmd, Vignettes, and documentation first</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Step 3: Build</b></span></li>
<li class="chapter" data-level="10" data-path="build-app-golem.html"><a href="build-app-golem.html"><i class="fa fa-check"></i><b>10</b> Building the App with <code>{golem}</code></a>
<ul>
<li class="chapter" data-level="10.1" data-path="build-app-golem.html"><a href="build-app-golem.html#add-dependencies"><i class="fa fa-check"></i><b>10.1</b> Add dependencies</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="build-app-golem.html"><a href="build-app-golem.html#package-dependencies"><i class="fa fa-check"></i><b>10.1.1</b> Package dependencies</a></li>
<li class="chapter" data-level="10.1.2" data-path="build-app-golem.html"><a href="build-app-golem.html#importing-packages-and-functions"><i class="fa fa-check"></i><b>10.1.2</b> Importing packages and functions</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="build-app-golem.html"><a href="build-app-golem.html#submodules-and-utility-functions"><i class="fa fa-check"></i><b>10.2</b> Submodules and utility functions</a></li>
<li class="chapter" data-level="10.3" data-path="build-app-golem.html"><a href="build-app-golem.html#add-tests"><i class="fa fa-check"></i><b>10.3</b> Add tests</a></li>
<li class="chapter" data-level="10.4" data-path="build-app-golem.html"><a href="build-app-golem.html#documentation-and-code-coverage"><i class="fa fa-check"></i><b>10.4</b> Documentation and code coverage</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="build-app-golem.html"><a href="build-app-golem.html#vignette"><i class="fa fa-check"></i><b>10.4.1</b> Vignette</a></li>
<li class="chapter" data-level="10.4.2" data-path="build-app-golem.html"><a href="build-app-golem.html#code-coverage-and-continuous-integration"><i class="fa fa-check"></i><b>10.4.2</b> Code coverage and continuous integration</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="build-app-golem.html"><a href="build-app-golem.html#using-golem-dev-functions"><i class="fa fa-check"></i><b>10.5</b> Using <code>{golem}</code> dev functions</a></li>
</ul></li>
<li class="part"><span><b>V Step 4: Strengthen</b></span></li>
<li class="chapter" data-level="11" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html"><i class="fa fa-check"></i><b>11</b> Build Yourself a Safety Net</a>
<ul>
<li class="chapter" data-level="11.1" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#testing-your-app"><i class="fa fa-check"></i><b>11.1</b> Testing your app</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#testing-the-business-logic"><i class="fa fa-check"></i><b>11.1.1</b> Testing the business logic</a></li>
<li class="chapter" data-level="11.1.2" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#shinytestserver"><i class="fa fa-check"></i><b>11.1.2</b> <code>shiny::testServer()</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#testing-the-interactive-logic"><i class="fa fa-check"></i><b>11.1.3</b> Testing the interactive logic</a></li>
<li class="chapter" data-level="11.1.4" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#testing-the-app-load"><i class="fa fa-check"></i><b>11.1.4</b> Testing the app load</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#a-reproducible-environment"><i class="fa fa-check"></i><b>11.2</b> A reproducible environment</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#renv"><i class="fa fa-check"></i><b>11.2.1</b> <code>{renv}</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="build-yourself-safety-net.html"><a href="build-yourself-safety-net.html#docker"><i class="fa fa-check"></i><b>11.2.2</b> Docker</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>12</b> Version Control</a>
<ul>
<li class="chapter" data-level="12.1" data-path="version-control.html"><a href="version-control.html#version-control-git"><i class="fa fa-check"></i><b>12.1</b> Using version control with <code>Git</code></a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="version-control.html"><a href="version-control.html#why-version-control"><i class="fa fa-check"></i><b>12.1.1</b> Why version control?</a></li>
<li class="chapter" data-level="12.1.2" data-path="version-control.html"><a href="version-control.html#git-basics-add---commit---push---pull"><i class="fa fa-check"></i><b>12.1.2</b> <code>Git</code> basics: <code>add</code> - <code>commit</code> - <code>push</code> - <code>pull</code></a></li>
<li class="chapter" data-level="12.1.3" data-path="version-control.html"><a href="version-control.html#about-branches"><i class="fa fa-check"></i><b>12.1.3</b> About branches</a></li>
<li class="chapter" data-level="12.1.4" data-path="version-control.html"><a href="version-control.html#issues"><i class="fa fa-check"></i><b>12.1.4</b> Issues</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="version-control.html"><a href="version-control.html#git-integration"><i class="fa fa-check"></i><b>12.2</b> <code>Git</code> integration</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="version-control.html"><a href="version-control.html#with-rstudio"><i class="fa fa-check"></i><b>12.2.1</b> With RStudio</a></li>
<li class="chapter" data-level="12.2.2" data-path="version-control.html"><a href="version-control.html#as-part-of-a-larger-world"><i class="fa fa-check"></i><b>12.2.2</b> As part of a larger world</a></li>
<li class="chapter" data-level="12.2.3" data-path="version-control.html"><a href="version-control.html#about-git-flow"><i class="fa fa-check"></i><b>12.2.3</b> About <code>git-flow</code></a></li>
<li class="chapter" data-level="12.2.4" data-path="version-control.html"><a href="version-control.html#further-readings-on-git"><i class="fa fa-check"></i><b>12.2.4</b> Further readings on <code>Git</code></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="version-control.html"><a href="version-control.html#automated-testing"><i class="fa fa-check"></i><b>12.3</b> Automated testing</a></li>
</ul></li>
<li class="part"><span><b>VI Step 5: Deploy</b></span></li>
<li class="chapter" data-level="13" data-path="deploy.html"><a href="deploy.html"><i class="fa fa-check"></i><b>13</b> Deploy Your Application</a>
<ul>
<li class="chapter" data-level="13.1" data-path="deploy.html"><a href="deploy.html#before-deployment-checklist"><i class="fa fa-check"></i><b>13.1</b> Before deployment checklist</a></li>
<li class="chapter" data-level="13.2" data-path="deploy.html"><a href="deploy.html#sharing-your-app-as-a-package"><i class="fa fa-check"></i><b>13.2</b> Sharing your app as a package</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="deploy.html"><a href="deploy.html#install-on-your-machine"><i class="fa fa-check"></i><b>13.2.1</b> Install on your machine</a></li>
<li class="chapter" data-level="13.2.2" data-path="deploy.html"><a href="deploy.html#share-as-a-built-package"><i class="fa fa-check"></i><b>13.2.2</b> Share as a built package</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="deploy.html"><a href="deploy.html#deploying-apps-with-golem"><i class="fa fa-check"></i><b>13.3</b> Deploying apps with <code>{golem}</code></a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="deploy.html"><a href="deploy.html#rstudio-environments"><i class="fa fa-check"></i><b>13.3.1</b> RStudio environments</a></li>
<li class="chapter" data-level="13.3.2" data-path="deploy.html"><a href="deploy.html#docker-1"><i class="fa fa-check"></i><b>13.3.2</b> Docker</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Optimizing</b></span></li>
<li class="chapter" data-level="14" data-path="need-for-optimization.html"><a href="need-for-optimization.html"><i class="fa fa-check"></i><b>14</b> The Need for Optimization</a>
<ul>
<li class="chapter" data-level="14.1" data-path="need-for-optimization.html"><a href="need-for-optimization.html#build-first-then-optimize"><i class="fa fa-check"></i><b>14.1</b> Build first, then optimize</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="need-for-optimization.html"><a href="need-for-optimization.html#identifying-bottlenecks"><i class="fa fa-check"></i><b>14.1.1</b> Identifying bottlenecks</a></li>
<li class="chapter" data-level="14.1.2" data-path="need-for-optimization.html"><a href="need-for-optimization.html#do-you-need-faster-functions"><i class="fa fa-check"></i><b>14.1.2</b> Do you need faster functions?</a></li>
<li class="chapter" data-level="14.1.3" data-path="need-for-optimization.html"><a href="need-for-optimization.html#dont-sacrifice-readability"><i class="fa fa-check"></i><b>14.1.3</b> Don’t sacrifice readability</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="need-for-optimization.html"><a href="need-for-optimization.html#tools-for-profiling"><i class="fa fa-check"></i><b>14.2</b> Tools for profiling</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="need-for-optimization.html"><a href="need-for-optimization.html#profiling-r-code"><i class="fa fa-check"></i><b>14.2.1</b> Profiling R code</a></li>
<li class="chapter" data-level="14.2.2" data-path="need-for-optimization.html"><a href="need-for-optimization.html#profiling-shiny"><i class="fa fa-check"></i><b>14.2.2</b> Profiling <code>{shiny}</code></a></li>
<li class="chapter" data-level="14.2.3" data-path="need-for-optimization.html"><a href="need-for-optimization.html#more-resources-about-web-page-performance"><i class="fa fa-check"></i><b>14.2.3</b> More resources about web-page performance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="common-app-caveats.html"><a href="common-app-caveats.html"><i class="fa fa-check"></i><b>15</b> Common Application Caveats</a>
<ul>
<li class="chapter" data-level="15.1" data-path="common-app-caveats.html"><a href="common-app-caveats.html#reactivity-anti-patterns"><i class="fa fa-check"></i><b>15.1</b> Reactivity anti-patterns</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="common-app-caveats.html"><a href="common-app-caveats.html#reactivity-is-awesome-until-it-is-not"><i class="fa fa-check"></i><b>15.1.1</b> Reactivity is awesome… until it is not</a></li>
<li class="chapter" data-level="15.1.2" data-path="common-app-caveats.html"><a href="common-app-caveats.html#observe-vs-observeevent"><i class="fa fa-check"></i><b>15.1.2</b> <code>observe</code> vs <code>observeEvent</code></a></li>
<li class="chapter" data-level="15.1.3" data-path="common-app-caveats.html"><a href="common-app-caveats.html#building-triggers-and-watchers"><i class="fa fa-check"></i><b>15.1.3</b> Building triggers and watchers</a></li>
<li class="chapter" data-level="15.1.4" data-path="common-app-caveats.html"><a href="common-app-caveats.html#using-r6-as-data-storage"><i class="fa fa-check"></i><b>15.1.4</b> Using R6 as data storage</a></li>
<li class="chapter" data-level="15.1.5" data-path="common-app-caveats.html"><a href="common-app-caveats.html#logging-reactivity-with-whereami"><i class="fa fa-check"></i><b>15.1.5</b> Logging reactivity with <code>{whereami}</code></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="common-app-caveats.html"><a href="common-app-caveats.html#r-does-too-much"><i class="fa fa-check"></i><b>15.2</b> R does too much</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="common-app-caveats.html"><a href="common-app-caveats.html#rendering-the-ui-from-the-server-side"><i class="fa fa-check"></i><b>15.2.1</b> Rendering the UI from the server side</a></li>
<li class="chapter" data-level="15.2.2" data-path="common-app-caveats.html"><a href="common-app-caveats.html#too-much-data-in-memory"><i class="fa fa-check"></i><b>15.2.2</b> Too much data in memory</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="common-app-caveats.html"><a href="common-app-caveats.html#reading-data"><i class="fa fa-check"></i><b>15.3</b> Reading data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="common-app-caveats.html"><a href="common-app-caveats.html#including-data-in-your-application"><i class="fa fa-check"></i><b>15.3.1</b> Including data in your application</a></li>
<li class="chapter" data-level="15.3.2" data-path="common-app-caveats.html"><a href="common-app-caveats.html#reading-external-datasets"><i class="fa fa-check"></i><b>15.3.2</b> Reading external datasets</a></li>
<li class="chapter" data-level="15.3.3" data-path="common-app-caveats.html"><a href="common-app-caveats.html#using-external-databases"><i class="fa fa-check"></i><b>15.3.3</b> Using external databases</a></li>
<li class="chapter" data-level="15.3.4" data-path="common-app-caveats.html"><a href="common-app-caveats.html#data-source-checklist"><i class="fa fa-check"></i><b>15.3.4</b> Data-source checklist</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html"><i class="fa fa-check"></i><b>16</b> Optimizing <code>{shiny}</code> Code</a>
<ul>
<li class="chapter" data-level="16.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#optimizing-r-code"><i class="fa fa-check"></i><b>16.1</b> Optimizing R code</a></li>
<li class="chapter" data-level="16.2" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#caching-elements"><i class="fa fa-check"></i><b>16.2</b> Caching elements</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#what-is-caching"><i class="fa fa-check"></i><b>16.2.1</b> What is caching?</a></li>
<li class="chapter" data-level="16.2.2" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#native-caching-in-r"><i class="fa fa-check"></i><b>16.2.2</b> Native caching in R</a></li>
<li class="chapter" data-level="16.2.3" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#caching-in-shiny"><i class="fa fa-check"></i><b>16.2.3</b> Caching in <code>{shiny}</code></a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#asynchronous-in-shiny"><i class="fa fa-check"></i><b>16.3</b> Asynchronous in <code>{shiny}</code></a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="optimizing-shiny-code.html"><a href="optimizing-shiny-code.html#how-to"><i class="fa fa-check"></i><b>16.3.1</b> How to</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="using-javascript.html"><a href="using-javascript.html"><i class="fa fa-check"></i><b>17</b> Using JavaScript</a>
<ul>
<li class="chapter" data-level="17.1" data-path="using-javascript.html"><a href="using-javascript.html#introduction-1"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="using-javascript.html"><a href="using-javascript.html#a-quick-introduction-to-javascript"><i class="fa fa-check"></i><b>17.2</b> A quick introduction to JavaScript</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="using-javascript.html"><a href="using-javascript.html#about-javascript"><i class="fa fa-check"></i><b>17.2.1</b> About JavaScript</a></li>
<li class="chapter" data-level="17.2.2" data-path="using-javascript.html"><a href="using-javascript.html#including-javascript-code-in-your-app"><i class="fa fa-check"></i><b>17.2.2</b> Including JavaScript code in your app</a></li>
<li class="chapter" data-level="17.2.3" data-path="using-javascript.html"><a href="using-javascript.html#understanding-html-class-and-id"><i class="fa fa-check"></i><b>17.2.3</b> Understanding HTML, class, and id</a></li>
<li class="chapter" data-level="17.2.4" data-path="using-javascript.html"><a href="using-javascript.html#querying-in-vanilla-javascript"><i class="fa fa-check"></i><b>17.2.4</b> Querying in Vanilla JavaScript</a></li>
<li class="chapter" data-level="17.2.5" data-path="using-javascript.html"><a href="using-javascript.html#about-dom-events"><i class="fa fa-check"></i><b>17.2.5</b> About DOM events</a></li>
<li class="chapter" data-level="17.2.6" data-path="using-javascript.html"><a href="using-javascript.html#about-jquery-and-jquery-selectors"><i class="fa fa-check"></i><b>17.2.6</b> About <code>jQuery</code> and <code>jQuery</code> selectors</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="using-javascript.html"><a href="using-javascript.html#client-side-javascript"><i class="fa fa-check"></i><b>17.3</b> Client-side JavaScript</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="using-javascript.html"><a href="using-javascript.html#common-patterns"><i class="fa fa-check"></i><b>17.3.1</b> Common patterns</a></li>
<li class="chapter" data-level="17.3.2" data-path="using-javascript.html"><a href="using-javascript.html#where-to-put-them-back-to-javascript-events"><i class="fa fa-check"></i><b>17.3.2</b> Where to put them: Back to JavaScript Events</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="using-javascript.html"><a href="using-javascript.html#javascript---shiny-communication"><i class="fa fa-check"></i><b>17.4</b> JavaScript &lt;-&gt; <code>{shiny}</code> communication</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="using-javascript.html"><a href="using-javascript.html#from-r-to-javascript"><i class="fa fa-check"></i><b>17.4.1</b> From R to JavaScript</a></li>
<li class="chapter" data-level="17.4.2" data-path="using-javascript.html"><a href="using-javascript.html#from-javascript-to-r"><i class="fa fa-check"></i><b>17.4.2</b> From JavaScript to R</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="using-javascript.html"><a href="using-javascript.html#about-shinyjs-js-functions"><i class="fa fa-check"></i><b>17.5</b> About <code>{shinyjs}</code> JS functions</a></li>
<li class="chapter" data-level="17.6" data-path="using-javascript.html"><a href="using-javascript.html#one-last-thing-api-calls"><i class="fa fa-check"></i><b>17.6</b> One last thing: API calls</a></li>
<li class="chapter" data-level="17.7" data-path="using-javascript.html"><a href="using-javascript.html#learn-more-about-javascript"><i class="fa fa-check"></i><b>17.7</b> Learn more about JavaScript</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="using-javascript.html"><a href="using-javascript.html#shiny-and-javascript"><i class="fa fa-check"></i><b>17.7.1</b> <code>{shiny}</code> and JavaScript</a></li>
<li class="chapter" data-level="17.7.2" data-path="using-javascript.html"><a href="using-javascript.html#javascript-basics"><i class="fa fa-check"></i><b>17.7.2</b> JavaScript basics</a></li>
<li class="chapter" data-level="17.7.3" data-path="using-javascript.html"><a href="using-javascript.html#jquery"><i class="fa fa-check"></i><b>17.7.3</b> jQuery</a></li>
<li class="chapter" data-level="17.7.4" data-path="using-javascript.html"><a href="using-javascript.html#intermediateadvanced-javascript"><i class="fa fa-check"></i><b>17.7.4</b> Intermediate/advanced JavaScript</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="css.html"><a href="css.html"><i class="fa fa-check"></i><b>18</b> A Gentle Introduction to CSS</a>
<ul>
<li class="chapter" data-level="18.1" data-path="css.html"><a href="css.html#what-is-css"><i class="fa fa-check"></i><b>18.1</b> What is CSS?</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="css.html"><a href="css.html#about-css"><i class="fa fa-check"></i><b>18.1.1</b> About CSS</a></li>
<li class="chapter" data-level="18.1.2" data-path="css.html"><a href="css.html#shinys-default-fluidpage"><i class="fa fa-check"></i><b>18.1.2</b> <code>{shiny}</code>’s default: <code>fluidPage()</code></a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="css.html"><a href="css.html#getting-started-with-css"><i class="fa fa-check"></i><b>18.2</b> Getting started with CSS</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="css.html"><a href="css.html#about-css-syntax"><i class="fa fa-check"></i><b>18.2.1</b> About CSS syntax</a></li>
<li class="chapter" data-level="18.2.2" data-path="css.html"><a href="css.html#css-selectors"><i class="fa fa-check"></i><b>18.2.2</b> CSS selectors</a></li>
<li class="chapter" data-level="18.2.3" data-path="css.html"><a href="css.html#css-properties"><i class="fa fa-check"></i><b>18.2.3</b> CSS properties</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="css.html"><a href="css.html#integrate-css-files-in-your-shiny-app"><i class="fa fa-check"></i><b>18.3</b> Integrate CSS files in your <code>{shiny}</code> app</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="css.html"><a href="css.html#inline-css"><i class="fa fa-check"></i><b>18.3.1</b> Inline CSS</a></li>
<li class="chapter" data-level="18.3.2" data-path="css.html"><a href="css.html#writing-in-a-tagsstyle"><i class="fa fa-check"></i><b>18.3.2</b> Writing in a <code>tags$style()</code></a></li>
<li class="chapter" data-level="18.3.3" data-path="css.html"><a href="css.html#including-external-files"><i class="fa fa-check"></i><b>18.3.3</b> Including external files</a></li>
<li class="chapter" data-level="18.3.4" data-path="css.html"><a href="css.html#using-r-packages"><i class="fa fa-check"></i><b>18.3.4</b> Using R packages</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="css.html"><a href="css.html#external-resources"><i class="fa fa-check"></i><b>18.4</b> External resources</a></li>
</ul></li>
<li class="part"><span><b>VIII Appendix</b></span></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html"><i class="fa fa-check"></i>Appendix A - Use Case: Building an App from Start to Finish</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#about-the-application"><i class="fa fa-check"></i>About the application</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#step-1-design-1"><i class="fa fa-check"></i>Step 1: Design</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#deciphering-the-specifications"><i class="fa fa-check"></i>Deciphering the specifications</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#building-a-concept-map"><i class="fa fa-check"></i>Building a concept map</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#asking-questions"><i class="fa fa-check"></i>Asking questions</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#building-personas-1"><i class="fa fa-check"></i>Building personas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#step-2-prototyping"><i class="fa fa-check"></i>Step 2: Prototyping</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#back-end-in-rmd"><i class="fa fa-check"></i>Back-end in Rmd</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#ui-prototyping"><i class="fa fa-check"></i>UI prototyping</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#step-3-build-1"><i class="fa fa-check"></i>Step 3: Build</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#step-4-strengthen-1"><i class="fa fa-check"></i>Step 4: Strengthen</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#step-5-deploy-1"><i class="fa fa-check"></i>Step 5: Deploy</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#before-deployment-checklist-1"><i class="fa fa-check"></i>Before deployment checklist</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#deploy-as-a-tar.gz"><i class="fa fa-check"></i>Deploy as a tar.gz</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#deploy-on-rstudio-connect"><i class="fa fa-check"></i>Deploy on RStudio Connect</a></li>
<li class="chapter" data-level="" data-path="appendix-a---use-case-building-an-app-from-start-to-finish.html"><a href="appendix-a---use-case-building-an-app-from-start-to-finish.html#deploy-with-docker"><i class="fa fa-check"></i>Deploy with Docker</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-b---session-info.html"><a href="appendix-b---session-info.html"><i class="fa fa-check"></i>Appendix B - Session Info</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://rtask.thinkr.fr">A book by the ThinkR team</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Engineering Production-Grade Shiny Apps</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="need-for-optimization" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> The Need for Optimization<a href="need-for-optimization.html#need-for-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>Only once we have a solid characterization of the surface area we want to improve can we begin to identify the best way to improve it.</p>
<p><em>Refactoring at Scale</em> <span class="citation">(<a href="#ref-lemaire2020">Lemaire 2020</a>)</span></p>
</blockquote>
<div id="build-first-then-optimize" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Build first, then optimize<a href="need-for-optimization.html#build-first-then-optimize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="identifying-bottlenecks" class="section level3 hasAnchor" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Identifying bottlenecks<a href="need-for-optimization.html#identifying-bottlenecks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Refactoring existing code for speed sounds like an appealing activity for a lot of us: it is always satisfying to watch our functions get faster, or finding a more elegant way to solve a problem that also results in making your code a little bit faster.
Or as Maude Lemaire writes in <em>Refactoring at Scale</em> <span class="citation">(<a href="#ref-lemaire2020">Lemaire 2020</a>)</span>, “Refactoring can be a little bit like eating brownies: the first few bites are delicious, making it easy to get carried away and accidentally eat an entire dozen. When you’ve taken your last bite, a bit of regret and perhaps a twinge of nausea kick in.”</p>
<p>But beware!
As Donald Knuth puts it “Premature optimization is the root of all evil”.
What does that mean?
That <strong>focusing on optimizing small portions of your app before making it work fully is the best way to lose time along the way, even more in the context of a production application, where there are deadlines and a limited amount of time to build the application</strong>.
Why?
Here is the general idea: let’s say the schema in Figure <a href="need-for-optimization.html#fig:14-when-optimize-1">14.1</a> represents your software, and its goal is to make things travel from <em>X1</em> to <em>X2</em>, but you have a bottleneck at <em>U</em>.
You are building elements piece by piece: first, the portion <code>X1.1</code> of the “road”, then <code>X1.2</code>, etc.
Only when you have your application ready can you really appreciate where your bottleneck is, and you can focus on making things go fast from <code>X1.1</code> to <code>X.1.2</code>, these performance gains won’t make your application go faster: you will only make the elements move faster to the bottleneck.</p>
<p>When?
Once the application is ready: here in our example, we can only detect the bottleneck once the full road is actually built, not while we are building the circle.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:14-when-optimize-1"></span>
<img src="img/bottleneck.png" alt="Road bottleneck, from WikiMedia https://commons.wikimedia.org/wiki/File:Roadway_section_with_bottleneck.png." width="100%" />
<p class="caption">
FIGURE 14.1: Road bottleneck, from WikiMedia <a href="https://commons.wikimedia.org/wiki/File:Roadway_section_with_bottleneck.png" class="uri">https://commons.wikimedia.org/wiki/File:Roadway_section_with_bottleneck.png</a>.
</p>
</div>
<p>This bottleneck is the very thing you should be optimizing: <strong>having faster code anywhere else except this bottleneck will not make your app faster</strong>: you will just make your app reach the bottleneck faster, but there will still be this part of your app that slows everything down.
But this is something you might only realize when the app is fully built: pieces might be fast individually, but slow when put together.
It is also possible that the test dataset you have been using from the start works just fine, but when you try your app with a bigger, more realistic dataset, the application is actually way slower than it should be.
And, maybe you have been using an example dataset so that you do not have to query the database every time you implement a new feature, but the SQL query to the database is actually very slow.
This is something you will discover only when the application is fully functional, not when building the parts, and realizing that when you only have 5% of the allocated time for this project left on your calendar is not a good surprise.</p>
<p>Or to sum up:</p>
<div style="page-break-after: always;"></div>
<blockquote>
<p>Get your design right with an un-optimized, slow, memory-intensive implementation before you try to tune.
Then, tune systematically, looking for the places where you can buy big performance wins with the smallest possible increases in local complexity.</p>
<p><em>The Art of UNIX Programming</em> <span class="citation">(<a href="#ref-ericraymond2003">Raymond 2003</a>)</span></p>
</blockquote>
</div>
<div id="do-you-need-faster-functions" class="section level3 hasAnchor" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Do you need faster functions?<a href="need-for-optimization.html#do-you-need-faster-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Optimizing an app is a matter of trade-offs: of course, in a perfect world, every piece of the app would be tailored to be fast, easy to maintain, and elegant.
But in the real world, you have deadlines, limited time and resources, and we are all but humans.
That means that at the end of the day, your app will not be completely perfect: software can <strong>always</strong> be made better.
No piece of code has ever reached complete perfection.</p>
<p>Given that, <strong>do you want to spend 5 days out of the 30 you have planned optimizing a function so that it runs in a quarter of a second instead of half a second</strong>, then realize the critical bottleneck of your app is actually the SQL query and not the data manipulation?
Of course a function running twice as fast is a good thing, but think about it in context: for example, how many times is this function called?
We can safely bet that if your function is only called once, working on making it twice as fast might not be the one function you would want to focus on (well, unless you have unlimited time to work on your project, and in that case lucky you; you can spend a massive amount of time building the perfect software).
On the other hand, the function which is called thousands of times in your application might benefit from being optimized.</p>
<p>And all of this is basic maths.
Let’s assume the following:</p>
<ul>
<li>A current scenario takes 300 seconds to be accomplished on your application.</li>
<li>One function <code>A()</code> takes 30 seconds, and it’s called once.</li>
<li>One function <code>B()</code> takes 1 second, and it’s called 50 times.</li>
</ul>
<p>If you divide the execution time of <code>A()</code> by two, you would be performing a local optimization of 15 seconds, and a global optimization of 15 seconds.
On the other hand, if you divide the execution time of <code>B()</code> by two, you would be performing a local optimization of 0.5 seconds, but a global optimization of 25 seconds.</p>
<p>Again, this kind of optimization is hard to detect until the app is functional.
An optimization of 15 seconds is way greater than an optimization of 0.5 seconds.
Yet you will only realize that once the application is up and running!</p>
</div>
<div id="dont-sacrifice-readability" class="section level3 hasAnchor" number="14.1.3">
<h3><span class="header-section-number">14.1.3</span> Don’t sacrifice readability<a href="need-for-optimization.html#dont-sacrifice-readability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As said in the last section, every piece of code can be rewritten to be faster, either from R to R or using a lower-level language: for example C or C++.
You can also rebuild data manipulation code switching from one package to another, or use a complex data structures to optimize memory usage, etc.</p>
<p>But that comes with a price: <strong>not keeping things simple for the sake of local optimization makes maintenance harder, even more if you are using a lesser-known language/package</strong>.
Refactoring a piece of code is better done when you keep in mind that “the primary goal should be to produce human-friendly code, even at the cost of your original design. If the laser focus is on the solution rather than the process, there’s a greater chance your application will end up more contrived and complicated than it was in the first place” <span class="citation">(<a href="#ref-lemaire2020">Lemaire 2020</a>)</span>.</p>
<p>For example, switching some portions of your code to C++ implies that you might be the only person who can maintain that specific portion of code, or that your colleague taking over the project will have to spend hours learning the tools you have been building, or the language you have chosen to write your functions with.</p>
<p>Again, <strong>optimization is always a matter of trade-off</strong>: is the half-second local optimization worth the extra hours you will have to spend correcting bugs when the app will crash and when you will be the only one able to correct it?
Also, are the extra hours/days spent rewriting a working code-base worth the speed gain of 0.5 seconds on one function?</p>
<p>For example, let’s compare both these implementations of the same function, one in R, and one in C++ via <code>{Rcpp}</code> <span class="citation">(<a href="#ref-R-Rcpp">Eddelbuettel et al. 2024</a>)</span>.
Of course, the C++ function is faster than the R one—this is the very reason for using C++ with R.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="need-for-optimization.html#cb212-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Rcpp&quot;</span>)</span>
<span id="cb212-2"><a href="need-for-optimization.html#cb212-2" tabindex="-1"></a><span class="co"># A C++ function to compute the mean</span></span>
<span id="cb212-3"><a href="need-for-optimization.html#cb212-3" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&quot;</span></span>
<span id="cb212-4"><a href="need-for-optimization.html#cb212-4" tabindex="-1"></a><span class="st">double mean_cpp(NumericVector x) {</span></span>
<span id="cb212-5"><a href="need-for-optimization.html#cb212-5" tabindex="-1"></a><span class="st">  int j;</span></span>
<span id="cb212-6"><a href="need-for-optimization.html#cb212-6" tabindex="-1"></a><span class="st">  int size = x.size();</span></span>
<span id="cb212-7"><a href="need-for-optimization.html#cb212-7" tabindex="-1"></a><span class="st">  double res = 0;</span></span>
<span id="cb212-8"><a href="need-for-optimization.html#cb212-8" tabindex="-1"></a><span class="st">  for (j = 0; j &lt; size; j++){</span></span>
<span id="cb212-9"><a href="need-for-optimization.html#cb212-9" tabindex="-1"></a><span class="st">    res = res + x[j];</span></span>
<span id="cb212-10"><a href="need-for-optimization.html#cb212-10" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb212-11"><a href="need-for-optimization.html#cb212-11" tabindex="-1"></a><span class="st">  return res / size;</span></span>
<span id="cb212-12"><a href="need-for-optimization.html#cb212-12" tabindex="-1"></a><span class="st">}&quot;</span>)</span>
<span id="cb212-13"><a href="need-for-optimization.html#cb212-13" tabindex="-1"></a></span>
<span id="cb212-14"><a href="need-for-optimization.html#cb212-14" tabindex="-1"></a><span class="co"># Computing the mean using base R and C++, </span></span>
<span id="cb212-15"><a href="need-for-optimization.html#cb212-15" tabindex="-1"></a><span class="co"># and comparing the time spent on each</span></span>
<span id="cb212-16"><a href="need-for-optimization.html#cb212-16" tabindex="-1"></a>benched <span class="ot">&lt;-</span> bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb212-17"><a href="need-for-optimization.html#cb212-17" tabindex="-1"></a>  <span class="at">cpp =</span> <span class="fu">mean_cpp</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>),</span>
<span id="cb212-18"><a href="need-for-optimization.html#cb212-18" tabindex="-1"></a>  <span class="at">native =</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100000</span>), </span>
<span id="cb212-19"><a href="need-for-optimization.html#cb212-19" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">1000</span></span>
<span id="cb212-20"><a href="need-for-optimization.html#cb212-20" tabindex="-1"></a>)</span>
<span id="cb212-21"><a href="need-for-optimization.html#cb212-21" tabindex="-1"></a>benched</span></code></pre></div>
<pre><code># A tibble: 2 × 6
  expression    min median `itr/sec` mem_alloc `gc/sec`
  &lt;bch:expr&gt; &lt;bch:&gt; &lt;bch:&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;
1 cpp         151µs  155µs     4639.     784KB     18.6
2 native      692µs  701µs     1424.        0B      0  </code></pre>
<p>(Note: we will come back to <code>bench::mark()</code> later.)</p>
<p>However, how much is a time gain worth if you are not sure you can get someone on your team to take over the maintenance if needed?
In other words, given that (in our example) we are gaining around -5.4599^{-4} on the execution time of our function, is it worth switching to C++?
Using external languages or complex data structures implies that from the start, you will need to think about who and how your codebase will be maintained over the years.</p>
<p>Chances are that if you plan on using a <code>{shiny}</code> application during a span of several years, various R developers will be working on the project, and including C++ code inside your application means that these future developers will either be required to know C++, or they will not be able to maintain this piece of code.</p>
<p>So, to sum up, there are three ways to optimize your application and R code, and the bad news is that you cannot optimize for all of them:</p>
<ul>
<li>Optimizing for speed</li>
<li>Optimizing for memory</li>
<li>Optimizing for readability/maintainability</li>
</ul>
<p>Leading a successful project means that you should, as much as possible, find the perfect balance between these three.</p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="tools-for-profiling" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Tools for profiling<a href="need-for-optimization.html#tools-for-profiling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="profiling-r-code" class="section level3 hasAnchor" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Profiling R code<a href="need-for-optimization.html#profiling-r-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-identifying-bottlenecks" class="section level4 unnumbered hasAnchor">
<h4>A. Identifying bottlenecks<a href="need-for-optimization.html#a.-identifying-bottlenecks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The best way to profile R code is by using the <code>{profvis}</code> <span class="citation">(<a href="#ref-R-profvis">Chang, Luraschi, and Mastny 2023</a>)</span> package,<a href="#fn53" class="footnote-ref" id="fnref53"><sup>53</sup></a> a package designed to evaluate how much time each part of a function call takes.
With <code>{profvis}</code>, you can spot the bottleneck in your function.
Without an automated tool to do the profiling, the developers would have to profile by guessing, which will, most of the time, come with bad results:</p>
<blockquote>
<p>One of the lessons that the original Unix programmers learned early is that intuition is a poor guide to where the bottlenecks are, even for one who knows the code in question intimately.</p>
<p><em>The Art of UNIX Programming</em> <span class="citation">(<a href="#ref-ericraymond2003">Raymond 2003</a>)</span></p>
</blockquote>
<p>Instead of guessing, it is a safe bet to go for a tool like <code>{profvis}</code>, which allows you to have a detailed view of what takes a long time to run in your R code.</p>
<p>Using this package is quite straightforward: put the code you want to benchmark inside the <code>profvis()</code> function,<a href="#fn54" class="footnote-ref" id="fnref54"><sup>54</sup></a> wait for the code to run, and that is it; you now have an analysis of your code running time.</p>
<p>Here is an example with 3 nested functions, <code>top()</code>, <code>middle()</code> and <code>bottom()</code>, where <code>top()</code> calls <code>middle()</code> which calls <code>bottom()</code>:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="need-for-optimization.html#cb214-1" tabindex="-1"></a><span class="fu">library</span>(profvis)</span>
<span id="cb214-2"><a href="need-for-optimization.html#cb214-2" tabindex="-1"></a>top <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb214-3"><a href="need-for-optimization.html#cb214-3" tabindex="-1"></a>  <span class="co"># We use profvis::pause() because Sys.sleep() doesn&#39;t </span></span>
<span id="cb214-4"><a href="need-for-optimization.html#cb214-4" tabindex="-1"></a>  <span class="co"># show in the flame graph</span></span>
<span id="cb214-5"><a href="need-for-optimization.html#cb214-5" tabindex="-1"></a>  <span class="fu">pause</span>(<span class="fl">0.1</span>)</span>
<span id="cb214-6"><a href="need-for-optimization.html#cb214-6" tabindex="-1"></a>  <span class="co"># Running a series of function with lapply()</span></span>
<span id="cb214-7"><a href="need-for-optimization.html#cb214-7" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(x){</span>
<span id="cb214-8"><a href="need-for-optimization.html#cb214-8" tabindex="-1"></a>    x <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb214-9"><a href="need-for-optimization.html#cb214-9" tabindex="-1"></a>  })</span>
<span id="cb214-10"><a href="need-for-optimization.html#cb214-10" tabindex="-1"></a>  <span class="co"># Calling a lower level function</span></span>
<span id="cb214-11"><a href="need-for-optimization.html#cb214-11" tabindex="-1"></a>  <span class="fu">middle</span>()</span>
<span id="cb214-12"><a href="need-for-optimization.html#cb214-12" tabindex="-1"></a>}</span>
<span id="cb214-13"><a href="need-for-optimization.html#cb214-13" tabindex="-1"></a></span>
<span id="cb214-14"><a href="need-for-optimization.html#cb214-14" tabindex="-1"></a>middle <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb214-15"><a href="need-for-optimization.html#cb214-15" tabindex="-1"></a>  <span class="co"># Pausing before computing, and calling other functions</span></span>
<span id="cb214-16"><a href="need-for-optimization.html#cb214-16" tabindex="-1"></a>  <span class="fu">pause</span>(<span class="fl">0.2</span>)</span>
<span id="cb214-17"><a href="need-for-optimization.html#cb214-17" tabindex="-1"></a>  <span class="fl">1e4</span> <span class="sc">*</span> <span class="dv">9</span></span>
<span id="cb214-18"><a href="need-for-optimization.html#cb214-18" tabindex="-1"></a>  <span class="fu">bottom_a</span>()</span>
<span id="cb214-19"><a href="need-for-optimization.html#cb214-19" tabindex="-1"></a>  <span class="fu">bottom_b</span>()</span>
<span id="cb214-20"><a href="need-for-optimization.html#cb214-20" tabindex="-1"></a>}</span>
<span id="cb214-21"><a href="need-for-optimization.html#cb214-21" tabindex="-1"></a></span>
<span id="cb214-22"><a href="need-for-optimization.html#cb214-22" tabindex="-1"></a><span class="co"># Both will pause and print, _a for 0.5 seconds, </span></span>
<span id="cb214-23"><a href="need-for-optimization.html#cb214-23" tabindex="-1"></a><span class="co"># _b for 2 seconds</span></span>
<span id="cb214-24"><a href="need-for-optimization.html#cb214-24" tabindex="-1"></a>bottom_a <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb214-25"><a href="need-for-optimization.html#cb214-25" tabindex="-1"></a>  <span class="fu">pause</span>(<span class="fl">0.5</span>)</span>
<span id="cb214-26"><a href="need-for-optimization.html#cb214-26" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;hey&quot;</span>)</span>
<span id="cb214-27"><a href="need-for-optimization.html#cb214-27" tabindex="-1"></a>}</span>
<span id="cb214-28"><a href="need-for-optimization.html#cb214-28" tabindex="-1"></a>bottom_b <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb214-29"><a href="need-for-optimization.html#cb214-29" tabindex="-1"></a>  <span class="fu">pause</span>(<span class="dv">2</span>)</span>
<span id="cb214-30"><a href="need-for-optimization.html#cb214-30" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;hey&quot;</span>)</span>
<span id="cb214-31"><a href="need-for-optimization.html#cb214-31" tabindex="-1"></a>}</span>
<span id="cb214-32"><a href="need-for-optimization.html#cb214-32" tabindex="-1"></a><span class="fu">profvis</span>({</span>
<span id="cb214-33"><a href="need-for-optimization.html#cb214-33" tabindex="-1"></a>  <span class="fu">top</span>()</span>
<span id="cb214-34"><a href="need-for-optimization.html#cb214-34" tabindex="-1"></a>})</span></code></pre></div>
<p>What you see now is called a <code>flame graph</code>: it is a detailed timing of how your function has run, with a clear decomposition of the call stack.
What you see in the top window is the expression evaluated, and on the bottom the details of the call stack, with what looks a little bit like a Gantt diagram.
This result reads as follow: the wider the function call, the more time it has taken R to compute this piece of code.
On the very bottom, the “top” function (i.e. the function which is directly called in the console), and the higher you go, the more you enter the nested function calls.</p>
<p>Here is how to read the graph in <a href="need-for-optimization.html#fig:14-when-optimize-4">14.2</a>:</p>
<ul>
<li><p>On the x axis is the time spent computing the whole function.
Our <code>top()</code> function being the only one executed, it takes the whole record time.</p></li>
<li><p>Then, the second line shows the functions which are called inside <code>top()</code>.
First, R pauses, then does a series of calls to <code>FUN</code> (which is the internal anonymous function from <code>lapply()</code>), and then calls the <code>middle()</code> function.</p></li>
<li><p>Then, the third line details the calls made by <code>middle()</code>, which pauses, then calls <code>bottom_a()</code> and <code>bottom_b()</code>, which each <code>pause()</code> for a given amount of time.</p></li>
</ul>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:14-when-optimize-4"></span>
<img src="img/profviz_flame.png" alt="{profvis} flame graph." width="100%" />
<p class="caption">
FIGURE 14.2: <code>{profvis}</code> flame graph.
</p>
</div>
<p>If you click on the “Data” tab, you will also find another view of the <code>flame graph</code>, shown in <a href="need-for-optimization.html#fig:14-when-optimize-5">14.3</a>, where you can read the hierarchy of calls and the time and memory spent on each function call:</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:14-when-optimize-5"></span>
<img src="img/profviz_data.png" alt="{profvis} data tab." width="100%" />
<p class="caption">
FIGURE 14.3: <code>{profvis}</code> data tab.
</p>
</div>
<p>If you are working on profiling the memory usage, you can also use the <code>{profmem}</code> <span class="citation">(<a href="#ref-R-profmem">Bengtsson 2020</a>)</span> package which, instead of focusing on execution time, will record the memory usage of calls.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="need-for-optimization.html#cb215-1" tabindex="-1"></a><span class="fu">library</span>(profmem)</span>
<span id="cb215-2"><a href="need-for-optimization.html#cb215-2" tabindex="-1"></a><span class="co"># Computing the memory used by each c</span></span>
<span id="cb215-3"><a href="need-for-optimization.html#cb215-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">profmem</span>({</span>
<span id="cb215-4"><a href="need-for-optimization.html#cb215-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">raw</span>(<span class="dv">1000</span>)</span>
<span id="cb215-5"><a href="need-for-optimization.html#cb215-5" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb215-6"><a href="need-for-optimization.html#cb215-6" tabindex="-1"></a>})</span>
<span id="cb215-7"><a href="need-for-optimization.html#cb215-7" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>Rprofmem memory profiling of:
{
    x &lt;- raw(1000)
    A &lt;- matrix(rnorm(100), ncol = 10)
}

Memory allocations:
       what bytes               calls
1     alloc  1048               raw()
2     alloc   280            matrix()
3     alloc   560            matrix()
4     alloc   560            matrix()
5     alloc  1072            matrix()
6     alloc   848 matrix() -&gt; rnorm()
7     alloc  2552 matrix() -&gt; rnorm()
8     alloc   848            matrix()
9     alloc   528          &lt;internal&gt;
10    alloc  1648          &lt;internal&gt;
11    alloc  1648          &lt;internal&gt;
12    alloc  1072          &lt;internal&gt;
13    alloc   256          &lt;internal&gt;
14    alloc   456          &lt;internal&gt;
15    alloc   216          &lt;internal&gt;
16    alloc   256          &lt;internal&gt;
total       13848                    </code></pre>
<p>You can also get the total allocated memory with:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="need-for-optimization.html#cb217-1" tabindex="-1"></a><span class="fu">total</span>(p)</span></code></pre></div>
<pre><code>[1] 13848</code></pre>
<p>And extract specific values based on the memory allocation:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="need-for-optimization.html#cb219-1" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(p, bytes <span class="sc">&gt;</span> <span class="dv">1000</span>)</span>
<span id="cb219-2"><a href="need-for-optimization.html#cb219-2" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code></pre></div>
<pre><code>Rprofmem memory profiling of:
{
    x &lt;- raw(1000)
    A &lt;- matrix(rnorm(100), ncol = 10)
}

Memory allocations:
       what bytes               calls
1     alloc  1048               raw()
5     alloc  1072            matrix()
7     alloc  2552 matrix() -&gt; rnorm()
10    alloc  1648          &lt;internal&gt;
11    alloc  1648          &lt;internal&gt;
12    alloc  1072          &lt;internal&gt;
total        9040                    </code></pre>
<p>(Example extracted from <code>{profmem}</code> help page).</p>
<p>Here it is; now you have a tool to identify bottlenecks!</p>
</div>
<div id="b.-benchmarking-r-code" class="section level4 unnumbered hasAnchor">
<h4>B. Benchmarking R code<a href="need-for-optimization.html#b.-benchmarking-r-code" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Identifying bottlenecks is a start, but what to do now?
In the next chapter about optimization, we will dive deeper into common strategies for optimizing R and <code>{shiny}</code> code.
But before that, remember this rule: <strong>never start optimizing if you cannot benchmark this optimization</strong>.
Why?
Because developers are not perfect at identifying bottlenecks and estimating if something is faster or not, and some optimization methods might lead to slower code.
Of course, most of the time they will not, but in some cases adopting optimization methods leads to writing slower code, because we have missed a bottleneck in our new code.
And of course, without a clear documentation of what we are doing, we will be missing it, relying only on our intuition as a rough guess of speed gain.</p>
<p>In other words, if you want to be sure that you are actually optimizing, be sure that you have a basis for comparison.</p>
<p>How to do that?
One thing that can be done is to keep an RMarkdown file with your starting point: use this notebook to keep track of what you are doing, by noting where you are starting from (i.e, what’s the original function you want to optimize), and compare it with the new one.
By using an Rmd, you can document the strategies you have been using to optimize the code, e.ga: “switched from for loop to vectorize function”, “changed from x to y”, etc.
This will also be helpful for the future: either for you in other projects (you can get back to this document), or for other developers, as it will explain why specific decisions have been made.</p>
<p>To do the timing computation, you can use the <code>{bench}</code> <span class="citation">(<a href="#ref-R-bench">Hester and Vaughan 2023</a>)</span> package, which compares the execution time (and other metrics) of two functions.
This function takes a series of named elements, each containing an R expression that will be timed.
Note that by default, the <code>mark()</code> function compares the output of each function,</p>
<p>Once the timing is done, you will get a data.frame with various metrics about the benchmark.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="need-for-optimization.html#cb221-1" tabindex="-1"></a><span class="co"># Multiplying each element of a vector going from 1 to size</span></span>
<span id="cb221-2"><a href="need-for-optimization.html#cb221-2" tabindex="-1"></a><span class="co"># with a for loop </span></span>
<span id="cb221-3"><a href="need-for-optimization.html#cb221-3" tabindex="-1"></a>for_loop <span class="ot">&lt;-</span> <span class="cf">function</span>(size){</span>
<span id="cb221-4"><a href="need-for-optimization.html#cb221-4" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">numeric</span>(size)</span>
<span id="cb221-5"><a href="need-for-optimization.html#cb221-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>size){</span>
<span id="cb221-6"><a href="need-for-optimization.html#cb221-6" tabindex="-1"></a>    res[i] <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb221-7"><a href="need-for-optimization.html#cb221-7" tabindex="-1"></a>  }</span>
<span id="cb221-8"><a href="need-for-optimization.html#cb221-8" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb221-9"><a href="need-for-optimization.html#cb221-9" tabindex="-1"></a>}</span>
<span id="cb221-10"><a href="need-for-optimization.html#cb221-10" tabindex="-1"></a><span class="co"># Doing the same thing using a vectorized function</span></span>
<span id="cb221-11"><a href="need-for-optimization.html#cb221-11" tabindex="-1"></a>vectorized <span class="ot">&lt;-</span> <span class="cf">function</span>(size){</span>
<span id="cb221-12"><a href="need-for-optimization.html#cb221-12" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">:</span>size) <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb221-13"><a href="need-for-optimization.html#cb221-13" tabindex="-1"></a>}</span>
<span id="cb221-14"><a href="need-for-optimization.html#cb221-14" tabindex="-1"></a>res <span class="ot">&lt;-</span> bench<span class="sc">::</span><span class="fu">mark</span>(</span>
<span id="cb221-15"><a href="need-for-optimization.html#cb221-15" tabindex="-1"></a>  <span class="at">for_loop =</span> <span class="fu">for_loop</span>(<span class="dv">1000</span>), </span>
<span id="cb221-16"><a href="need-for-optimization.html#cb221-16" tabindex="-1"></a>  <span class="at">vectorized =</span> <span class="fu">vectorized</span>(<span class="dv">1000</span>), </span>
<span id="cb221-17"><a href="need-for-optimization.html#cb221-17" tabindex="-1"></a>  <span class="at">iterations =</span> <span class="dv">1000</span></span>
<span id="cb221-18"><a href="need-for-optimization.html#cb221-18" tabindex="-1"></a>)</span>
<span id="cb221-19"><a href="need-for-optimization.html#cb221-19" tabindex="-1"></a>res</span></code></pre></div>
<pre><code># A tibble: 2 × 6
  expression      min   median `itr/sec` mem_alloc
  &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;
1 for_loop    42.08µs  42.86µs    23061.    30.3KB
2 vectorized   2.13µs   2.48µs   236377.    11.8KB
# ℹ 1 more variable: `gc/sec` &lt;dbl&gt;</code></pre>
<p>Here, we have an empirical evidence that one code is faster than the other: by benchmarking the speed of our code, we are able to determine which function is the fastest.</p>
<p>If you want a graphical analysis, <code>{bench}</code> comes with an <code>autoplot</code> method for <code>{ggplot2}</code> <span class="citation">(<a href="#ref-R-ggplot2">Wickham, Chang, et al. 2024</a>)</span>, as shown in Figure <a href="need-for-optimization.html#fig:14-when-optimize-10">14.4</a>:</p>

<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="need-for-optimization.html#cb223-1" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:14-when-optimize-10"></span>
<img src="engineering-production-grade-shiny-apps_files/figure-html/14-when-optimize-10-1.png" alt="{bench} autoplot." width="100%" />
<p class="caption">
FIGURE 14.4: <code>{bench}</code> autoplot.
</p>
</div>
<p>And, bonus point, <code>{bench}</code> takes time to check that the two outputs are the same, so that you are sure you are comparing the very same thing, which is another crucial aspect of benchmarking: be sure you are not comparing apples with oranges!</p>
</div>
</div>
<div id="profiling-shiny" class="section level3 hasAnchor" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Profiling <code>{shiny}</code><a href="need-for-optimization.html#profiling-shiny" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a.-shiny-back-end" class="section level4 unnumbered hasAnchor">
<h4>A. <code>{shiny}</code> back-end<a href="need-for-optimization.html#a.-shiny-back-end" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You can profile <code>{shiny}</code> applications using the <code>{profvis}</code> package, just as any other piece of R code.
The only thing to note is that if you want to use this function with an app built with <code>{golem}</code> <span class="citation">(<a href="#ref-R-golem">Fay et al. 2024</a>)</span>, you will have to wrap the <code>run_app()</code> function in a <code>print()</code> function.
Long story short, what makes the app run is not the function itself, but the printing of the function, so the object returned by <code>run_app()</code> itself cannot be profiled.
See the discussion of this <a href="https://github.com/ThinkR-open/golem/issues/146">issue on the <code>{golem}</code> repository</a> to learn more about this.</p>
</div>
<div id="b.-shiny-front-end" class="section level4 unnumbered hasAnchor">
<h4>B. <code>{shiny}</code> front-end<a href="need-for-optimization.html#b.-shiny-front-end" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="google-lighthouse" class="section level5 unnumbered hasAnchor">
<h5>Google Lighthouse<a href="need-for-optimization.html#google-lighthouse" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>One other thing that can be optimized when it comes to the user interface is the web page rendering performance.
To do that, we can use standard web development tools: as said several times, a <code>{shiny}</code> application IS a web application, so tools that are language agnostic will work with <code>{shiny}</code>.
There are thousands of tools available to do exactly that, and going through all of them would probably not make a lot of sense.</p>
<p>Let’s focus on getting started with a basic but powerful tool, that comes for free inside your browser: <a href="https://developers.google.com/web/tools/lighthouse">Google Lighthouse</a>, one of the famous tools for profiling web pages, is bundled into recent versions of Google Chrome.
The nice thing is that this tool not only covers what you see (i.e. not only what you are actually rendering on your personal computer), but can also audit your app with various configurations, notably on mobile, with low bandwidth and/or mimicking a 3G connection.
<strong>Being able to perform an audit of our application as seen on a mobile device is a real strength: we are developing an application on our computer, and might not be regularly checking how our application is performing on a mobile. Yet a large portion of web navigation is performed on a mobile or tablet</strong>.</p>
<p>Already in 2016, Google <a href="https://www.thinkwithgoogle.com/data/web-traffic-from-smartphones-and-tablets/">wrote</a> that “<em>More than half of all web traffic now comes from smartphones and tablets</em>”.
Knowing the exact number of visitors that browse through mobile is hard: the web is vast, and not all websites record the traffic they receive.
Yet many, if not all, studies of how the web is browsed report the same results: more traffic is created via mobile than via computer.<a href="#fn55" class="footnote-ref" id="fnref55"><sup>55</sup></a></p>
<p>And, the advantages of running it in your browser is that it can perform the analysis on locally deployed applications: in other words, you can launch your <code>{shiny}</code> application in your R console, open the app in Google Chrome, and run the audit.
A lot of online services need a URL to do the audit!</p>
<p>Each result from the audit comes with advice and changes you can make to your application to make it better, with links to know more about the specific issue.</p>
<p>And of course, last but not least, you also get the results of the metrics you have “passed”.
It is always a good mood booster to see our app passing some audited points!</p>
<p>Here is a quick introduction to this tool:</p>
<ul>
<li>Open Chrome in incognito mode (File &gt; New Icognito Window),<a href="#fn56" class="footnote-ref" id="fnref56"><sup>56</sup></a> so that the page performance is not influenced by any of the installed extensions in your Google Chrome.</li>
<li>Open your developer console, either by going to View &gt; Developer &gt; Developer tools, by right-clicking &gt; Inspect, or with the keyboard shortcut ctrl/cmd + alt + I, as shown in Figure <a href="need-for-optimization.html#fig:14-when-optimize-11">14.5</a>.</li>
<li>Go to the “Audit” tab.</li>
<li>Configure your report (or leave the default).</li>
<li>Click on “Generate Report”.</li>
</ul>
<p>Note that you can also install a command-line tool with <code>npm install -g lighthouse</code>,<a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a> then run <code>lighthouse http://urlto.audit</code>: it will produce either a JSON (if asked) or an HTML report (the default).</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:14-when-optimize-11"></span>
<img src="img/lighthouse-audit.png" alt="Launching Lighthouse audit from Google Chrome." width="100%" />
<p class="caption">
FIGURE 14.5: Launching Lighthouse audit from Google Chrome.
</p>
</div>
<p>See Figure <a href="need-for-optimization.html#fig:14-when-optimize-12">14.6</a> for a screenshot of the results computed by Google Lighthouse.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:14-when-optimize-12"></span>
<img src="img/lighthouse-audit-results.png" alt="Lighthouse audit results." width="100%" />
<p class="caption">
FIGURE 14.6: Lighthouse audit results.
</p>
</div>
<p>Once the audit is finished, you have some basic but useful indications about your application:</p>
<ul>
<li><p>Performance.
This metric mostly analyzes the rendering time of the page: for example, how much time does it take to load the app in full, that is to say how much time it takes from the first byte received to the app being fully ready to be used, the time between the very first call to the server and the very first response, etc.
With <code>{shiny}</code> <span class="citation">(<a href="#ref-R-shiny">Chang et al. 2023</a>)</span>, you should get low performance here, notably due to the fact that it is serving external dependencies that you might not be able to control.
For example, the report from <code>{hexmake}</code> <span class="citation">(<a href="#ref-R-hexmake">Fay 2024d</a>)</span> suggests to “Eliminate render-blocking resources”, and most of them are not controlled by the shiny developer: they come bundled with <code>shiny::fluidPage()</code> itself.</p></li>
<li><p>Accessibility.
Google Lighthouse performs a series of accessibility tests (see our chapter about accessibility for more information).</p></li>
<li><p>Best practices bundles a list of “misc” best practices around web applications.</p></li>
<li><p>SEO, search engine optimization, or how your app will perform when it comes to search engine indexation.<a href="#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a></p></li>
<li><p>Progressive Web App (PWA): A PWA is an app that can run on any device, <em>“reaching anyone, anywhere, on any device with a single codebase”</em>.
Google audit your application to see if your application fits with this idea.</p></li>
</ul>
<p>Profiling web page is a wide topic and a lot of things can be done to enhance the global page performance.
That being said, if you have a limited time to invest in optimizing the front-end performance of the application, Google Lighthouse is a perfect tool, and can be your go-to audit tool for your application.</p>
<p>And if you want to do it from R, the npm lighthouse module allows you to output the audit in JSON, which can then be brought back to R!</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb224-1"><a href="need-for-optimization.html#cb224-1" tabindex="-1"></a><span class="ex">lighthouse</span> <span class="at">--output</span> json <span class="dt">\</span></span>
<span id="cb224-2"><a href="need-for-optimization.html#cb224-2" tabindex="-1"></a>  <span class="at">--output-path</span> data-raw/output.json <span class="dt">\</span></span>
<span id="cb224-3"><a href="need-for-optimization.html#cb224-3" tabindex="-1"></a>  http://localhost:2811</span></code></pre></div>
<p>Then, being a JSON file, you can call if from R:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="need-for-optimization.html#cb225-1" tabindex="-1"></a><span class="co"># Reading the JSON output of your lighthouse audit, </span></span>
<span id="cb225-2"><a href="need-for-optimization.html#cb225-2" tabindex="-1"></a><span class="co"># and displaying the Speed Index value</span></span>
<span id="cb225-3"><a href="need-for-optimization.html#cb225-3" tabindex="-1"></a>lighthouse_report <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">read_json</span>(<span class="st">&quot;data-raw/output.json&quot;</span>)</span>
<span id="cb225-4"><a href="need-for-optimization.html#cb225-4" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">speed-index</span><span class="st">`</span><span class="sc">$</span>displayValue</span></code></pre></div>
<pre><code>[1] &quot;5.4 s&quot;</code></pre>
<p>The results are contained in the <code>audits</code> sections of this object, and each of these sub-elements contains a <code>description</code> field, detailing what the metric means.</p>
<p>Here are, for example, some of the results, focused on performance, with their respective descriptions:</p>
</div>
<div id="first-meaningful-paint" class="section level5 unnumbered hasAnchor">
<h5>“First Meaningful Paint”<a href="need-for-optimization.html#first-meaningful-paint" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="need-for-optimization.html#cb227-1" tabindex="-1"></a><span class="co"># Each audit point contains a description, </span></span>
<span id="cb227-2"><a href="need-for-optimization.html#cb227-2" tabindex="-1"></a><span class="co"># that explains what this value stands for</span></span>
<span id="cb227-3"><a href="need-for-optimization.html#cb227-3" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">first-meaningful-paint</span><span class="st">`</span><span class="sc">$</span>description</span></code></pre></div>
<pre><code>[1] &quot;First Meaningful Paint measures when the primary&quot;
[2] &quot;content of a page is visible. [Learn&quot;            
[3] &quot;more](https://web.dev/first-meaningful-paint).&quot;  </code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="need-for-optimization.html#cb229-1" tabindex="-1"></a><span class="co"># We can turn the results into a data frame</span></span>
<span id="cb229-2"><a href="need-for-optimization.html#cb229-2" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">first-meaningful-paint</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="need-for-optimization.html#cb229-3" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb229-4"><a href="need-for-optimization.html#cb229-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(title, score, displayValue)</span></code></pre></div>
<pre><code># A tibble: 1 × 3
  title                  score displayValue
  &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;       
1 First Meaningful Paint  0.23 5.4 s       </code></pre>
</div>
<div id="speed-index" class="section level5 unnumbered hasAnchor">
<h5>“Speed Index”<a href="need-for-optimization.html#speed-index" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="need-for-optimization.html#cb231-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">speed-index</span><span class="st">`</span><span class="sc">$</span>description</span></code></pre></div>
<pre><code>[1] &quot;Speed Index shows how quickly the contents of a page&quot;
[2] &quot;are visibly populated. [Learn&quot;                       
[3] &quot;more](https://web.dev/speed-index).&quot;                 </code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="need-for-optimization.html#cb233-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">speed-index</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb233-2"><a href="need-for-optimization.html#cb233-2" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb233-3"><a href="need-for-optimization.html#cb233-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(title, score, displayValue) </span></code></pre></div>
<pre><code># A tibble: 1 × 3
  title       score displayValue
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;       
1 Speed Index  0.56 5.4 s       </code></pre>
</div>
<div id="estimated-input-latency" class="section level5 unnumbered hasAnchor">
<h5>“Estimated Input Latency”<a href="need-for-optimization.html#estimated-input-latency" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="need-for-optimization.html#cb235-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">estimated-input-latency</span><span class="st">`</span><span class="sc">$</span>description </span></code></pre></div>
<pre><code>[1] &quot;Estimated Input Latency is an estimate of how long&quot;   
[2] &quot;your app takes to respond to user input, in&quot;          
[3] &quot;milliseconds, during the busiest 5s window of page&quot;   
[4] &quot;load. If your latency is higher than 50 ms, users may&quot;
[5] &quot;perceive your app as laggy. [Learn&quot;                   
[6] &quot;more](https://web.dev/estimated-input-latency).&quot;      </code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="need-for-optimization.html#cb237-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">estimated-input-latency</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb237-2"><a href="need-for-optimization.html#cb237-2" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb237-3"><a href="need-for-optimization.html#cb237-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(title, score, displayValue) </span></code></pre></div>
<pre><code># A tibble: 1 × 3
  title                   score displayValue
  &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt;       
1 Estimated Input Latency     1 10 ms       </code></pre>
</div>
<div id="total-blocking-time" class="section level5 unnumbered hasAnchor">
<h5>“Total Blocking Time”<a href="need-for-optimization.html#total-blocking-time" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="need-for-optimization.html#cb239-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">total-blocking-time</span><span class="st">`</span><span class="sc">$</span>description </span></code></pre></div>
<pre><code>[1] &quot;Sum of all time periods between FCP and Time to&quot;       
[2] &quot;Interactive, when task length exceeded 50ms, expressed&quot;
[3] &quot;in milliseconds.&quot;                                      </code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="need-for-optimization.html#cb241-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">total-blocking-time</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb241-2"><a href="need-for-optimization.html#cb241-2" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()  <span class="sc">%&gt;%</span></span>
<span id="cb241-3"><a href="need-for-optimization.html#cb241-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(title, score, displayValue)</span></code></pre></div>
<pre><code># A tibble: 1 × 3
  title               score displayValue
  &lt;chr&gt;               &lt;int&gt; &lt;chr&gt;       
1 Total Blocking Time     1 30 ms       </code></pre>
</div>
<div id="time-to-first-byte" class="section level5 unnumbered hasAnchor">
<h5>“Time to first Byte”<a href="need-for-optimization.html#time-to-first-byte" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="need-for-optimization.html#cb243-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">time-to-first-byte</span><span class="st">`</span><span class="sc">$</span>description </span></code></pre></div>
<pre><code>[1] &quot;Time To First Byte identifies the time at which your&quot;
[2] &quot;server sends a response. [Learn&quot;                     
[3] &quot;more](https://web.dev/time-to-first-byte).&quot;          </code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="need-for-optimization.html#cb245-1" tabindex="-1"></a>lighthouse_report<span class="sc">$</span>audits<span class="sc">$</span><span class="st">`</span><span class="at">time-to-first-byte</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb245-2"><a href="need-for-optimization.html#cb245-2" tabindex="-1"></a>  .[<span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;score&quot;</span>, <span class="st">&quot;displayValue&quot;</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb245-3"><a href="need-for-optimization.html#cb245-3" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() </span></code></pre></div>
<pre><code># A tibble: 1 × 3
  title                              score displayValue
  &lt;chr&gt;                              &lt;int&gt; &lt;chr&gt;       
1 Server response times are low (TT…     1 Root docume…</code></pre>
<p>Google Lighthouse also comes with a continuous integration tool, so that you can use it as a regression testing tool for your application.
To know more, feel free to read the <a href="https://github.com/GoogleChrome/lighthouse-ci/blob/master/docs/getting-started.md">documentation</a>!</p>
</div>
<div id="side-note-on-minification" class="section level5 unnumbered hasAnchor">
<h5>Side note on minification<a href="need-for-optimization.html#side-note-on-minification" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Chances are that right now you are not using <em>minification</em> in your <code>{shiny}</code> application.
Minification is the process of removing unnecessary characters from files, without changing the way the code works, to make the file size smaller.
The general idea being that line breaks, spaces, and a specific set of characters are used inside scripts for human readability, and are not useful when it comes to the way a computer reads a piece of code.
Why not remove them when they are served in a larger software?
This is what <em>minification</em> does.</p>
<p>Here is an example of how minification works, taken from <em>Empirical Study on Effects of Script Minification and HTTP Compression for Traffic Reduction</em> <span class="citation">(<a href="#ref-Sakamoto2015">Sakamoto et al. 2015</a>)</span>:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb247-1"><a href="need-for-optimization.html#cb247-1" tabindex="-1"></a><span class="kw">var</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb247-2"><a href="need-for-optimization.html#cb247-2" tabindex="-1"></a><span class="cf">for</span> ( <span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span><span class="dv">10</span><span class="op">;</span> i <span class="op">++</span> ) {</span>
<span id="cb247-3"><a href="need-for-optimization.html#cb247-3" tabindex="-1"></a>  sum <span class="op">+=</span> i <span class="op">;</span></span>
<span id="cb247-4"><a href="need-for-optimization.html#cb247-4" tabindex="-1"></a>}</span>
<span id="cb247-5"><a href="need-for-optimization.html#cb247-5" tabindex="-1"></a><span class="fu">alert</span>( sum ) <span class="op">;</span></span></code></pre></div>
<p>is minified into:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb248-1"><a href="need-for-optimization.html#cb248-1" tabindex="-1"></a><span class="kw">var</span> sum<span class="op">=</span><span class="dv">0</span><span class="op">;</span><span class="cf">for</span>(<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;=</span><span class="dv">10</span><span class="op">;</span>i<span class="op">++</span>){sum<span class="op">+=</span>i}<span class="op">;</span><span class="fu">alert</span>(sum)<span class="op">;</span></span></code></pre></div>
<p>Both these code blocks behave the same way, but the second one will be smaller when saved to a file: this is the very core principle of minification of files.
It is something pretty common to do when building web applications: on the web, every byte counts, so the smaller your external resources the better.
Minification is important as the larger your resources, the longer your application will take to launch, and:</p>
<ul>
<li><p>Page launch time is crucial when it comes to ranking the pages on the web.</p></li>
<li><p>The larger the resources, the longer it will take to launch the application on a mobile, notably if users are visiting your application from a 3G/4G network.</p></li>
</ul>
<p>And do not forget the following:</p>
<blockquote>
<p>Extremely high-speed network infrastructures are becoming more and more popular in developed countries.
However, we still face crowded and low-speed Wi-Fi environments on airport, cafe, international conference, etc.
Especially, a network environment of mobile devices requires efficient usage of network bandwidth.</p>
<p><em>Empirical study on effects of script minification and HTTP compression for traffic reduction</em> <span class="citation">(<a href="#ref-Sakamoto2015">Sakamoto et al. 2015</a>)</span></p>
</blockquote>
<p>To minify JavaScript, HTML and CSS files from R, you can use the <code>{minifyr}</code> <span class="citation">(<a href="#ref-R-minifyr"><strong>R-minifyr?</strong></a>)</span> package, which wraps the <code>node-minify</code> NodeJS library.
For example, compare the size of this file from <code>{shiny}</code>:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="need-for-optimization.html#cb249-1" tabindex="-1"></a><span class="co"># Displaying the file size of a CSS file from {shiny}</span></span>
<span id="cb249-2"><a href="need-for-optimization.html#cb249-2" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">file_size</span>(</span>
<span id="cb249-3"><a href="need-for-optimization.html#cb249-3" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;www/shared/shiny.js&quot;</span>, <span class="at">package =</span> <span class="st">&quot;shiny&quot;</span>)</span>
<span id="cb249-4"><a href="need-for-optimization.html#cb249-4" tabindex="-1"></a>) </span></code></pre></div>
<pre><code>239K</code></pre>
<p>To its minified version:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="need-for-optimization.html#cb251-1" tabindex="-1"></a><span class="co"># Using the {minifyr} package to minify the CSS file</span></span>
<span id="cb251-2"><a href="need-for-optimization.html#cb251-2" tabindex="-1"></a>minified <span class="ot">&lt;-</span> minifyr<span class="sc">::</span><span class="fu">minifyr_js_gcc</span>(</span>
<span id="cb251-3"><a href="need-for-optimization.html#cb251-3" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;www/shared/shiny.js&quot;</span>, <span class="at">package =</span> <span class="st">&quot;shiny&quot;</span>), </span>
<span id="cb251-4"><a href="need-for-optimization.html#cb251-4" tabindex="-1"></a>  <span class="st">&quot;shinymini.js&quot;</span></span>
<span id="cb251-5"><a href="need-for-optimization.html#cb251-5" tabindex="-1"></a>) </span></code></pre></div>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="need-for-optimization.html#cb252-1" tabindex="-1"></a><span class="co"># Minifying can help you gain kilobytes</span></span>
<span id="cb252-2"><a href="need-for-optimization.html#cb252-2" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">file_size</span>(minified)</span></code></pre></div>
<pre><code>87.5K</code></pre>
<p>That might not seem like much (a couple of KB) on a small scale, but as it can be done automatically, why not leverage these small performance gains when building larger applications?
Of course, minification will not suddenly make your application blazing fast, but that’s something you should consider when deploying an application to production, notably if you use a lot of packages with interactive widgets: they might contain CSS and JavaScript files that are not minified.</p>
<p>Minification can be important notably if you expect your audience to be connecting to your app with a low bandwidth: whenever your application starts, the browser has to download the source files from the server, meaning that the larger these files, the longer it will take to render.</p>
<p>Note that <code>{shiny}</code> files are minified by default, so you will not have to re-minify them.
But most packages that extend <code>{shiny}</code> are not, so minifying the CSS and JavaScript files from these packages might help you win some points on you Google Lighthouse report!</p>
<p>To do this automatically, you can add the <code>{minifyr}</code> commands to your deployment, be it on your CD/CI platform, or as a Dockerfile step.
<code>{minifyr}</code> comes with a series of functions to do that:</p>
<ul>
<li><code>minify_folder_css()</code>, <code>minify_folder_js()</code>, <code>minify_folder_html()</code> and <code>minify_folder_json()</code> do a bulk minification of the files found in a folder that matches the extension.</li>
<li><code>minify_package_js()</code>, <code>minify_package_css()</code>, <code>minify_package_html()</code> and <code>minify_package_json()</code> will minify the CSS and JavaScript files contained inside a package installed on the machine.</li>
</ul>
<p>Here is what it can look like inside a <code>Dockerfile</code> (Note that you will need to install NodeJS inside the container):</p>
<pre><code>FROM rocker/shiny-verse:3.6.3

RUN apt-get -y install curl 
RUN curl -sL \
  &lt;https://deb.nodesource.com/setup_14.x&gt; \
  | bash - 
RUN apt-get install -y nodejs

RUN Rscript -e &#39;remotes::install_github(&quot;colinfay/minifyr&quot;)&#39; 
RUN Rscript -e &#39;remotes::install_cran(&quot;cicerone&quot;)&#39; 
RUN Rscript -e &#39;library(minifyr);\
    minifyr_npm_install(TRUE);\
    minify_package_js(&quot;cicerone&quot;, minifyr_js_uglify)&#39;</code></pre>
</div>
</div>
</div>
<div id="more-resources-about-web-page-performance" class="section level3 hasAnchor" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> More resources about web-page performance<a href="need-for-optimization.html#more-resources-about-web-page-performance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><a href="https://developers.google.com/web/fundamentals/performance/why-performance-matters">Why Performance Matters - Google Web Fundamentals</a></p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/Performance">Web Performance - Mozilla Web Docs</a></p></li>
</ul>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-profmem" class="csl-entry">
Bengtsson, Henrik. 2020. <em>Profmem: Simple Memory Profiling for r</em>. <a href="https://github.com/HenrikBengtsson/profmem">https://github.com/HenrikBengtsson/profmem</a>.
</div>
<div id="ref-R-shiny" class="csl-entry">
Chang, Winston, Joe Cheng, JJ Allaire, Carson Sievert, Barret Schloerke, Yihui Xie, Jeff Allen, Jonathan McPherson, Alan Dipert, and Barbara Borges. 2023. <em>Shiny: Web Application Framework for r</em>. <a href="https://shiny.posit.co/">https://shiny.posit.co/</a>.
</div>
<div id="ref-R-profvis" class="csl-entry">
Chang, Winston, Javier Luraschi, and Timothy Mastny. 2023. <em>Profvis: Interactive Visualizations for Profiling r Code</em>. <a href="https://rstudio.github.io/profvis/">https://rstudio.github.io/profvis/</a>.
</div>
<div id="ref-R-Rcpp" class="csl-entry">
Eddelbuettel, Dirk, Romain Francois, JJ Allaire, Kevin Ushey, Qiang Kou, Nathan Russell, Inaki Ucar, Douglas Bates, and John Chambers. 2024. <em>Rcpp: Seamless r and c++ Integration</em>. <a href="https://www.rcpp.org">https://www.rcpp.org</a>.
</div>
<div id="ref-R-hexmake" class="csl-entry">
———. 2024d. <em>Hexmake: Hex Stickers Maker</em>. <a href="https://github.com/colinfay/hexmake">https://github.com/colinfay/hexmake</a>.
</div>
<div id="ref-R-golem" class="csl-entry">
Fay, Colin, Vincent Guyader, Sébastien Rochette, and Cervan Girard. 2024. <em>Golem: A Framework for Robust Shiny Applications</em>. <a href="https://github.com/ThinkR-open/golem">https://github.com/ThinkR-open/golem</a>.
</div>
<div id="ref-R-bench" class="csl-entry">
Hester, Jim, and Davis Vaughan. 2023. <em>Bench: High Precision Timing of r Expressions</em>. <a href="https://bench.r-lib.org/">https://bench.r-lib.org/</a>.
</div>
<div id="ref-lemaire2020" class="csl-entry">
Lemaire, Maude. 2020. <em>Refactoring at Scale</em>. Henry Holt. <a href="https://learning.oreilly.com/library/view/refactoring-at-scale/9781492075523/">https://learning.oreilly.com/library/view/refactoring-at-scale/9781492075523/</a>.
</div>
<div id="ref-ericraymond2003" class="csl-entry">
Raymond, Eric S. 2003. <em>The Art of UNIX Programming (the Addison-Wesley Professional Computng Series)</em>. Addison-Wesley.
</div>
<div id="ref-Sakamoto2015" class="csl-entry">
Sakamoto, Yasutaka, Shinsuke Matsumoto, Seiki Tokunaga, Sachio Saiki, and Masahide Nakamura. 2015. <span>“Empirical Study on Effects of Script Minification and <span>HTTP</span> Compression for Traffic Reduction.”</span> In <em>2015 Third International Conference on Digital Information, Networking, and Wireless Communications (<span>DINWC</span>)</em>. <span>IEEE</span>. <a href="https://doi.org/10.1109/dinwc.2015.7054230">https://doi.org/10.1109/dinwc.2015.7054230</a>.
</div>
<div id="ref-R-ggplot2" class="csl-entry">
Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, Dewey Dunnington, and Teun van den Brand. 2024. <em>Ggplot2: Create Elegant Data Visualisations Using the Grammar of Graphics</em>. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="53">
<li id="fn53"><p><code>{utils}</code> also comes with a function call <code>Rprof()</code>, but we will not be examining this one here, as <code>{profvis}</code> provides a more user-friendly and enhanced interface to this profiling function.<a href="need-for-optimization.html#fnref53" class="footnote-back">↩︎</a></p></li>
<li id="fn54"><p>Do not forget to add <code>{}</code> inside <code>profvis({})</code> if you want to write several lines of code.<a href="need-for-optimization.html#fnref54" class="footnote-back">↩︎</a></p></li>
<li id="fn55"><p>broadbandsearch <a href="https://www.broadbandsearch.net/blog/mobile-desktop-internet-usage-statistics" class="uri">https://www.broadbandsearch.net/blog/mobile-desktop-internet-usage-statistics</a> for example, reports a 53.3% share for mobile browsing.<a href="need-for-optimization.html#fnref55" class="footnote-back">↩︎</a></p></li>
<li id="fn56"><p>This mode opens an “anonymous” session, in the sense that you don’t have access to your account and extensions, and that the visits will not be recorded in your history.<a href="need-for-optimization.html#fnref56" class="footnote-back">↩︎</a></p></li>
<li id="fn57"><p>Being a NodeJS application, you will need to have NodeJS installed on your machine.<a href="need-for-optimization.html#fnref57" class="footnote-back">↩︎</a></p></li>
<li id="fn58"><p>Search engine indexation refers to how Google ranks your website in the search results for a given query.<a href="need-for-optimization.html#fnref58" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<hr/>
<footer>
<a href="https://rtask.thinkr.fr"><img src="img/logo400_129.png" alt="ThinkR Website"/></a>
<!--https://yihui.org/en/2018/09/target-blank/-->
<script>
  (function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>
</footer>
            </section>

          </div>
        </div>
      </div>
<a href="deploy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="common-app-caveats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ThinkR-open/building-shiny-apps-workflow/edit/master/14-when_optimize.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
